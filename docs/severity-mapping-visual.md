# Flowlyt SARIF Severity Mapping for GitHub Advanced Security

## Visual Mapping

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Flowlyt â†’ SARIF â†’ GitHub                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  CRITICAL (Flowlyt)                                                 â”‚
â”‚       â†“                                                              â”‚
â”‚  security-severity: 9.0  +  level: error                           â”‚
â”‚       â†“                                                              â”‚
â”‚  ğŸ”´ Critical (GitHub Security Tab)                                  â”‚
â”‚                                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  HIGH (Flowlyt)                                                     â”‚
â”‚       â†“                                                              â”‚
â”‚  security-severity: 8.0  +  level: error                           â”‚
â”‚       â†“                                                              â”‚
â”‚  ğŸŸ  High (GitHub Security Tab)                                      â”‚
â”‚                                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  MEDIUM (Flowlyt)                                                   â”‚
â”‚       â†“                                                              â”‚
â”‚  security-severity: 5.0  +  level: warning                         â”‚
â”‚       â†“                                                              â”‚
â”‚  ğŸŸ¡ Medium (GitHub Security Tab)                                    â”‚
â”‚                                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  LOW (Flowlyt)                                                      â”‚
â”‚       â†“                                                              â”‚
â”‚  security-severity: 3.0  +  level: warning                         â”‚
â”‚       â†“                                                              â”‚
â”‚  ğŸ”µ Low (GitHub Security Tab)                                       â”‚
â”‚                                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                      â”‚
â”‚  INFO (Flowlyt)                                                     â”‚
â”‚       â†“                                                              â”‚
â”‚  security-severity: 0.0  +  level: note                            â”‚
â”‚       â†“                                                              â”‚
â”‚  âšª Note (GitHub Security Tab)                                      â”‚
â”‚                                                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## GitHub Advanced Security Severity Score Ranges

GitHub Advanced Security interprets the `security-severity` property using these ranges:

| Score Range | Severity Display | Color in UI |
|-------------|-----------------|-------------|
| 9.0 - 10.0  | Critical        | ğŸ”´ Red       |
| 7.0 - 8.9   | High            | ğŸŸ  Orange    |
| 4.0 - 6.9   | Medium          | ğŸŸ¡ Yellow    |
| 0.1 - 3.9   | Low             | ğŸ”µ Blue      |
| 0.0         | Note            | âšª Gray      |

## Example: Before and After

### Before (Generic Error/Warning)
```
GitHub Security Tab:
â”œâ”€â”€ Error: Untrusted Action Source
â”œâ”€â”€ Error: Repository Jacking Vulnerability  
â”œâ”€â”€ Error: Git Reference Confusion
â””â”€â”€ Warning: Missing Permissions
```

### After (Specific Severity Levels)
```
GitHub Security Tab:
â”œâ”€â”€ ğŸ”´ Critical: Repository Jacking Vulnerability (9.0)
â”œâ”€â”€ ğŸŸ  High: Untrusted Action Source (8.0)
â”œâ”€â”€ ğŸŸ  High: Git Reference Confusion (8.0)
â””â”€â”€ ğŸ”µ Low: Missing Permissions (3.0)
```

## How It Works

When Flowlyt generates SARIF output, it now includes two complementary properties:

1. **SARIF `level`**: Required by the SARIF specification
   - `error`: For critical and high severity
   - `warning`: For medium and low severity  
   - `note`: For informational findings

2. **`security-severity`**: GitHub-specific numeric score
   - Provides precise severity mapping
   - Used by GitHub Advanced Security for display
   - Allows fine-grained filtering and sorting

Both properties work together to ensure findings display correctly across all platforms:
- **GitHub Advanced Security**: Uses `security-severity` for precise severity display
- **Other SARIF viewers**: Fall back to standard `level` property
- **IDEs and tools**: Compatible with both approaches

## Usage Example

```bash
# Generate SARIF report
flowlyt scan --repo . --output sarif --output-file results.sarif

# Upload to GitHub
gh api /repos/OWNER/REPO/code-scanning/sarifs \
  -F sarif=@results.sarif \
  -F commit_sha=$(git rev-parse HEAD) \
  -F ref=refs/heads/main
```

Or use GitHub Actions:

```yaml
- name: Upload SARIF to GitHub
  uses: github/codeql-action/upload-sarif@v3
  with:
    sarif_file: results.sarif
    category: flowlyt-security
```

## Benefits

âœ… **Clear Prioritization**: Instantly see which issues need immediate attention  
âœ… **Better Filtering**: Filter by severity in GitHub's UI  
âœ… **Accurate Metrics**: Security dashboards show correct severity distribution  
âœ… **Compliance Ready**: Meets security scanning standards for enterprise environments  
âœ… **Team Alignment**: Consistent severity language across tools

## Technical Details

The implementation adds the `security-severity` property to each rule definition in the SARIF output:

```json
{
  "rules": [{
    "id": "UNTRUSTED_ACTION_SOURCE",
    "name": "Untrusted Action Source",
    "defaultConfiguration": {
      "level": "error"
    },
    "properties": {
      "security-severity": "9.0",
      "severity": "CRITICAL",
      "category": "SUPPLY_CHAIN"
    }
  }]
}
```

This ensures GitHub Advanced Security displays the finding with the correct severity badge and allows proper filtering and sorting in the Security tab.
